{"id":"lc-21r","title":"Fix workflow quality gates and command boundaries","description":"Fixes critical, high, and medium priority issues found in the deep-dive analysis of Line Cook commands and agents.\n\nKey fixes:\n- P0: CC /run ignores serve verdict\n- P0: Tidy auto-closes epics, bypassing close-service quality gate\n- P1: Serve polisher→sous-chef order creates blind spots\n- P1: Verdict naming inconsistent across agents\n- P2: Cook-to-tidy finding transfer fragile\n- P2: In-progress triage too discretionary","status":"closed","priority":1,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-12T20:39:56.954083964-08:00","created_by":"Sam Biggins","updated_at":"2026-02-12T20:46:33.852351547-08:00","closed_at":"2026-02-12T20:46:33.852351547-08:00","close_reason":"Closed","comments":[{"id":8,"issue_id":"lc-21r","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: APPROVED\nIssues: 0 found (1 nit - emoji in bash template, internally consistent)\nPolish: 1 file refined (sous-chef.md.template - removed redundant conditional wrapping)\nSummary: All 5 fixes are logically sound, cross-references align across 20 files. Template sync correct for all 3 platforms. Verdict standardization complete with no stale references.","created_at":"2026-02-13T04:56:41Z"}]}
{"id":"lc-21r.1","title":"Add serve verdict handling to CC /run path","description":"The Claude Code path in run.md.template (Step 3) invokes serve but never checks the SERVE_RESULT verdict. It proceeds directly to Step 4 (tidy) regardless.\n\nThe OpenCode path correctly checks SERVE_RESULT and has a rework loop with up to 3 attempts.\n\nMeanwhile, serve itself says: \"Do NOT continue to tidy\" (on NEEDS_CHANGES).\n\nFix: Add explicit SERVE_RESULT verdict handling to the CC /run path, matching OpenCode's structure.\n\nFiles: core/templates/commands/run.md.template (lines 83-91 CC path)","status":"closed","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-12T20:40:05.270204679-08:00","created_by":"Sam Biggins","updated_at":"2026-02-12T20:42:40.73907525-08:00","closed_at":"2026-02-12T20:42:40.73907525-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lc-21r.1","depends_on_id":"lc-21r","type":"parent-child","created_at":"2026-02-12T20:40:05.272195994-08:00","created_by":"Sam Biggins"}]}
{"id":"lc-21r.2","title":"Move epic closure from tidy to close-service","description":"Tidy Step 4 (tidy.md.template:245-287) runs bd epic close-eligible and then merges the epic branch to main. This bypasses close-service entirely -- no E2E validation, no critic review, no acceptance documentation.\n\nFix:\n1. Tidy: Remove epic closure and branch merge logic. Replace with detection + suggestion to run close-service.\n2. Close-service: Add branch merge logic after epic validation passes.\n3. Run Step 5: Already correctly delegates to close-service, so no change needed there.\n\nFiles: \n- core/templates/commands/tidy.md.template (Step 4)\n- core/templates/commands/close-service.md.template (add Step 8.5 for branch merge)","status":"closed","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-12T20:40:10.705966899-08:00","created_by":"Sam Biggins","updated_at":"2026-02-12T20:42:40.750648839-08:00","closed_at":"2026-02-12T20:42:40.750648839-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lc-21r.2","depends_on_id":"lc-21r","type":"parent-child","created_at":"2026-02-12T20:40:10.707899748-08:00","created_by":"Sam Biggins"}]}
{"id":"lc-21r.3","title":"Reverse serve order to sous-chef then polisher","description":"Currently serve runs polisher (Edit access) before sous-chef (read-only reviewer). This creates attribution loss, anchoring bias, and no rollback path.\n\nFix (Option A from analysis): Reverse to sous-chef→polisher:\n1. Sous-chef reviews the original developer code → produces verdict + issues\n2. If APPROVED: polisher refines for clarity → changes go in a separate commit\n3. If NEEDS_CHANGES: send back to cook (no polish needed on code that needs rework)\n\nFiles: core/templates/commands/serve.md.template (Steps 2-3)","status":"closed","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-12T20:40:14.49795001-08:00","created_by":"Sam Biggins","updated_at":"2026-02-12T20:43:43.796155073-08:00","closed_at":"2026-02-12T20:43:43.796155073-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lc-21r.3","depends_on_id":"lc-21r","type":"parent-child","created_at":"2026-02-12T20:40:14.500689704-08:00","created_by":"Sam Biggins"}]}
{"id":"lc-21r.4","title":"Standardize verdict vocabulary across agents","description":"Current verdict vocabulary is inconsistent:\n- sous-chef: ready_for_tidy | needs_changes | blocked (lowercase_snake)\n- SERVE_RESULT: APPROVED | NEEDS_CHANGES | BLOCKED (UPPER_CASE)\n- taster: APPROVED | APPROVED WITH NOTES | REJECTED\n- maitre: APPROVED | NEEDS CHANGES | BLOCKED\n- critic: PASS | NEEDS_WORK | FAIL\n\nFix: Standardize sous-chef to use APPROVED | NEEDS_CHANGES | BLOCKED to match SERVE_RESULT.\n\nFiles:\n- core/templates/agents/sous-chef.md.template\n- core/templates/commands/serve.md.template (document mapping)","status":"closed","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-12T20:40:18.475847206-08:00","created_by":"Sam Biggins","updated_at":"2026-02-12T20:45:08.694627186-08:00","closed_at":"2026-02-12T20:45:08.694627186-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lc-21r.4","depends_on_id":"lc-21r","type":"parent-child","created_at":"2026-02-12T20:40:18.477756777-08:00","created_by":"Sam Biggins"},{"issue_id":"lc-21r.4","depends_on_id":"lc-21r.3","type":"blocks","created_at":"2026-02-12T20:40:29.840928763-08:00","created_by":"Sam Biggins"}]}
{"id":"lc-21r.5","title":"Fix cook-to-tidy finding transfer and in-progress triage","description":"Two P2 fixes:\n\n1. Cook-to-tidy finding transfer fragile: Tidy Step 2 says \"Review findings from cook and serve\" but doesn't tell the agent to read bead comments. In multi-session work with /clear, findings survive only in bead comments.\nFix: Tidy Step 2 should explicitly say to read bead comments (bd comments show \u003cid\u003e) for PHASE: COOK and PHASE: SERVE findings.\n\n2. In-progress triage too discretionary: Tidy Step 3 says \"If task appears complete based on git changes, close it. Do NOT ask the user.\" This is too much discretion for a non-interactive command.\nFix: Only close the current task (the one that was just cooked). Leave other in-progress tasks as-is with a note.\n\nFiles: core/templates/commands/tidy.md.template (Steps 2-3)","status":"closed","priority":2,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-12T20:40:25.305443794-08:00","created_by":"Sam Biggins","updated_at":"2026-02-12T20:45:52.063233103-08:00","closed_at":"2026-02-12T20:45:52.063233103-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lc-21r.5","depends_on_id":"lc-21r","type":"parent-child","created_at":"2026-02-12T20:40:25.307196074-08:00","created_by":"Sam Biggins"},{"issue_id":"lc-21r.5","depends_on_id":"lc-21r.2","type":"blocks","created_at":"2026-02-12T20:40:29.904757062-08:00","created_by":"Sam Biggins"}]}
{"id":"lc-7qb","title":"Retrospective","status":"closed","priority":4,"issue_type":"epic","owner":"sambiggins@gmail.com","created_at":"2026-02-08T20:24:46.492236563-08:00","created_by":"Sam Biggins","updated_at":"2026-02-08T20:37:55.590509143-08:00","closed_at":"2026-02-08T20:37:55.590509143-08:00","close_reason":"All children completed"}
{"id":"lc-7qb.1","title":"Add validation scripts to CI","description":"Discovery Source: Release process e2e audit\nDiscovered During: research phase\n\nImpact:\nValidation scripts (check-plugin-health, check-platform-parity, doctor-docs)\nonly run during release or manual invocation. Adding them to CI would catch\nversion drift and parity issues earlier.\n\nContext:\nCurrently no CI gate runs before release. CI only covers opencode plugin changes.","status":"closed","priority":3,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-08T20:24:56.971428506-08:00","created_by":"Sam Biggins","updated_at":"2026-02-08T20:37:43.437784347-08:00","closed_at":"2026-02-08T20:37:43.437784347-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lc-7qb.1","depends_on_id":"lc-7qb","type":"parent-child","created_at":"2026-02-08T20:24:56.973672451-08:00","created_by":"Sam Biggins"}],"comments":[{"id":1,"issue_id":"lc-7qb.1","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved\nIssues: 0 blocking (4 nits noted, 1 addressed)\nSummary: Script performance optimizations (truncation, caching, removed duplication) and template integration are clean. Polisher refined helpers, sous-chef found no blocking issues.","created_at":"2026-02-10T15:30:25Z"},{"id":2,"issue_id":"lc-7qb.1","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Optimize helper scripts for performance and wire them into agent templates\nBefore: Templates used 50+ lines of inline bash/jq for data collection; scripts had unbounded output\nAfter: Templates use single structured script calls; diffs capped at 200 lines, serve comments at 2000 chars, parent listings cached\n\nProblems encountered:\n  - (none)\n\nIssues filed:\n  - (none needed)\n\nCommit: c5e2c78\nPush: origin/main","created_at":"2026-02-10T15:46:10Z"},{"id":3,"issue_id":"lc-7qb.1","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved\nIssues: 0 blocking (3 nits noted, 1 addressed)\nSummary: Template cleanup removes redundant bd show/bd list/git status calls in cook and serve templates, replacing them with references to kitchen-equipment.py and diff-collector.py JSON output. No data gaps, accurate field references, consistent language.","created_at":"2026-02-10T16:04:00Z"},{"id":4,"issue_id":"lc-7qb.1","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Remove redundant subprocess calls from cook and serve templates\nBefore: Templates told agents to run bd show, bd list, git status alongside helper scripts — mixed signals\nAfter: Templates consistently reference kitchen-equipment.py and diff-collector.py JSON output\n\nProblems encountered:\n  - (none)\n\nIssues filed:\n  - (none needed)\n\nCommit: d4fd53e\nPush: origin/main","created_at":"2026-02-10T16:05:25Z"},{"id":5,"issue_id":"lc-7qb.1","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved\nIssues: 0 found (0 auto-fixed, 0 to-file)\nSummary:  additions to 4 templates follow established pattern consistently. Two cosmetic nits noted (bash snippet hardcodes path, Arguments line placement varies slightly) — both match existing patterns and are functionally irrelevant.","created_at":"2026-02-11T14:15:02Z"},{"id":6,"issue_id":"lc-7qb.1","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved\nIssues: 0 found (0 auto-fixed, 0 to-file)\nSummary: Clean implementation wiring all 5 OpenCode subagents. No issues found by polisher (3 minor refinements applied) or sous-chef (ready_for_tidy). Zero CC regressions.","created_at":"2026-02-12T06:30:10Z"},{"id":7,"issue_id":"lc-7qb.1","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Wire up all 5 OpenCode subagents (taster, polisher, sous-chef, maitre, critic)\nBefore: OpenCode used inline self-review in commands, no agent delegation\nAfter: All 5 agents delegated via Task tool with graceful fallbacks\n\nProblems encountered:\n  - (none)\n\nIssues filed:\n  - (none)\n\nCommit: b746515\nPush: success origin/main","created_at":"2026-02-12T06:34:36Z"}]}
{"id":"lc-7qb.2","title":"Add rollback on partial release failure","description":"Discovery Source: Release process e2e audit\nDiscovered During: research phase\n\nImpact:\nIf release.py fails mid-pipeline, modified files are left dirty. Currently\nprints rollback hint but could auto-rollback with git checkout on failure.\n\nContext:\nLow priority — single maintainer can easily run git checkout manually.\nThe rollback hint added in this session is sufficient for now.","status":"closed","priority":4,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-08T20:24:59.204873165-08:00","created_by":"Sam Biggins","updated_at":"2026-02-08T20:37:43.442342181-08:00","closed_at":"2026-02-08T20:37:43.442342181-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lc-7qb.2","depends_on_id":"lc-7qb","type":"parent-child","created_at":"2026-02-08T20:24:59.206575141-08:00","created_by":"Sam Biggins"}]}
{"id":"lc-7qb.3","title":"Strengthen changelog format validation in doctor-docs","description":"Discovery Source: Release process e2e audit\nDiscovered During: research phase\n\nImpact:\ndoctor-docs.py only warns if keepachangelog.com isn't referenced. Does not\nvalidate date format (ISO 8601), SemVer version sections, or comparison\nlink structure. Could catch malformed changelogs before release.\n\nContext:\nCurrent leniency hasn't caused issues but is a gap in validation coverage.","status":"closed","priority":4,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-08T20:25:04.075558402-08:00","created_by":"Sam Biggins","updated_at":"2026-02-08T20:37:43.461639091-08:00","closed_at":"2026-02-08T20:37:43.461639091-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lc-7qb.3","depends_on_id":"lc-7qb","type":"parent-child","created_at":"2026-02-08T20:25:04.077671741-08:00","created_by":"Sam Biggins"}]}
{"id":"lc-7qb.4","title":"Extract shared run_cmd/run_bd_json into helper module","description":"Discovery Source: Harden helper scripts session\nDiscovered During: serve phase (sous-chef review, 3 rounds)\n\nImpact:\nrun_cmd is copy-pasted identically across all 6 helper scripts.\nrun_bd_json is duplicated across 3 scripts. Growing maintenance cost\nif the pattern needs updating (e.g. adding timeout config).\n\nContext:\nScripts are standalone by design (no import dependencies), which is\nthe right choice for a plugin system. But at 6+ copies, extraction\ninto a shared helpers.py in the scripts directory would reduce drift.\nNot urgent — only worth doing if more scripts are added.","status":"open","priority":4,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-10T06:30:16.048089009-08:00","created_by":"Sam Biggins","updated_at":"2026-02-10T06:30:16.048089009-08:00","dependencies":[{"issue_id":"lc-7qb.4","depends_on_id":"lc-7qb","type":"parent-child","created_at":"2026-02-10T06:30:16.051930682-08:00","created_by":"Sam Biggins"}]}
